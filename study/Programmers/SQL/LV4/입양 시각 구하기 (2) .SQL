# WITH RECURSIVE HOURS AS
#     (
#         SELECT 0 AS HOUR
#         UNION ALL
#         SELECT 
#             HOUR + 1
#         FROM HOURS
#         WHERE HOUR < 23
#     )

# SELECT 
#     HOUR(DATETIME) AS HOUR, COUNT(*) AS COUNT
# FROM HOURS 
#     LEFT OUTER JOIN ANIMAL_OUTS ON (HOUR = HOUR(DATETIME)
# GROUP BY HOUR(DATETIME)
# ORDER BY HOUR(DATETIME)

#--------
                                    
WITH RECURSIVE HOURS AS
(
    SELECT 0 AS HOUR
    UNION ALL
    SELECT 
        HOUR + 1
    FROM HOURS
    WHERE HOUR < 23
)

SELECT 
    HOURS.HOUR, COUNT(ANIMAL_OUTS.DATETIME) AS COUNT
FROM HOURS
LEFT OUTER JOIN ANIMAL_OUTS ON HOURS.HOUR = HOUR(ANIMAL_OUTS.DATETIME)
GROUP BY HOURS.HOUR
ORDER BY HOURS.HOUR;

# 왼쪽 오른쪽 시간대를 합쳐야 되니깐